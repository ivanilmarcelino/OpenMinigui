/*
 * Harbour 3.2.0dev (r2503200530)
 * Borland C++ 5.8.2 (32-bit)
 * Generated C source from "h_registry.prg"
 */

#include "hbvmpub.h"
#include "hbinit.h"


HB_FUNC( TREG32 );
HB_FUNC_EXTERN( __CLSLOCKDEF );
HB_FUNC_EXTERN( HBCLASS );
HB_FUNC_EXTERN( HBOBJECT );
HB_FUNC_STATIC( TREG32_NEW );
HB_FUNC_STATIC( TREG32_CREATE );
HB_FUNC_STATIC( TREG32_GET );
HB_FUNC_STATIC( TREG32_SET );
HB_FUNC_STATIC( TREG32_DELETE );
HB_FUNC_EXTERN( REGCLOSEKEY );
HB_FUNC_EXTERN( __CLSUNLOCKDEF );
HB_FUNC_EXTERN( __OBJHASMSG );
HB_FUNC_EXTERN( REGOPENKEYEXA );
HB_FUNC_STATIC( ISWOW64 );
HB_FUNC_EXTERN( MSGSTOP );
HB_FUNC_EXTERN( HB_NTOS );
HB_FUNC_EXTERN( REGCREATEKEY );
HB_FUNC_EXTERN( VALTYPE );
HB_FUNC_EXTERN( REGQUERYVALUEEXA );
HB_FUNC_EXTERN( EMPTY );
HB_FUNC_STATIC( BIN2U );
HB_FUNC_EXTERN( CTOD );
HB_FUNC_EXTERN( UPPER );
HB_FUNC_EXTERN( DTOC );
HB_FUNC_EXTERN( REGSETVALUEEXA );
HB_FUNC_EXTERN( REGDELETEVALUEA );
HB_FUNC_EXTERN( BIN2L );
HB_FUNC( ISREGISTRYKEY );
HB_FUNC( CREATEREGISTRYKEY );
HB_FUNC( GETREGISTRYVALUE );
HB_FUNC( SETREGISTRYVALUE );
HB_FUNC( DELETEREGISTRYVAR );
HB_FUNC( DELETEREGISTRYKEY );
HB_FUNC_EXTERN( REGDELETEKEY );
HB_FUNC_INITSTATICS();


HB_INIT_SYMBOLS_BEGIN( hb_vm_SymbolInit_H_REGISTRY )
{ "TREG32", {HB_FS_PUBLIC | HB_FS_LOCAL}, {HB_FUNCNAME( TREG32 )}, NULL },
{ "__CLSLOCKDEF", {HB_FS_PUBLIC}, {HB_FUNCNAME( __CLSLOCKDEF )}, NULL },
{ "NEW", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "HBCLASS", {HB_FS_PUBLIC}, {HB_FUNCNAME( HBCLASS )}, NULL },
{ "HBOBJECT", {HB_FS_PUBLIC}, {HB_FUNCNAME( HBOBJECT )}, NULL },
{ "ADDMULTIDATA", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "ADDMETHOD", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "TREG32_NEW", {HB_FS_STATIC | HB_FS_LOCAL}, {HB_FUNCNAME( TREG32_NEW )}, NULL },
{ "TREG32_CREATE", {HB_FS_STATIC | HB_FS_LOCAL}, {HB_FUNCNAME( TREG32_CREATE )}, NULL },
{ "TREG32_GET", {HB_FS_STATIC | HB_FS_LOCAL}, {HB_FUNCNAME( TREG32_GET )}, NULL },
{ "TREG32_SET", {HB_FS_STATIC | HB_FS_LOCAL}, {HB_FUNCNAME( TREG32_SET )}, NULL },
{ "TREG32_DELETE", {HB_FS_STATIC | HB_FS_LOCAL}, {HB_FUNCNAME( TREG32_DELETE )}, NULL },
{ "ADDINLINE", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "LERROR", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "REGCLOSEKEY", {HB_FS_PUBLIC}, {HB_FUNCNAME( REGCLOSEKEY )}, NULL },
{ "NHANDLE", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "CREATE", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "__CLSUNLOCKDEF", {HB_FS_PUBLIC}, {HB_FUNCNAME( __CLSUNLOCKDEF )}, NULL },
{ "INSTANCE", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "__OBJHASMSG", {HB_FS_PUBLIC}, {HB_FUNCNAME( __OBJHASMSG )}, NULL },
{ "INITCLASS", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "REGOPENKEYEXA", {HB_FS_PUBLIC}, {HB_FUNCNAME( REGOPENKEYEXA )}, NULL },
{ "ISWOW64", {HB_FS_STATIC | HB_FS_LOCAL}, {HB_FUNCNAME( ISWOW64 )}, NULL },
{ "_LERROR", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "MSGSTOP", {HB_FS_PUBLIC}, {HB_FUNCNAME( MSGSTOP )}, NULL },
{ "HB_NTOS", {HB_FS_PUBLIC}, {HB_FUNCNAME( HB_NTOS )}, NULL },
{ "_CREGKEY", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "_NHANDLE", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "REGCREATEKEY", {HB_FS_PUBLIC}, {HB_FUNCNAME( REGCREATEKEY )}, NULL },
{ "_NERROR", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "VALTYPE", {HB_FS_PUBLIC}, {HB_FUNCNAME( VALTYPE )}, NULL },
{ "REGQUERYVALUEEXA", {HB_FS_PUBLIC}, {HB_FUNCNAME( REGQUERYVALUEEXA )}, NULL },
{ "EMPTY", {HB_FS_PUBLIC}, {HB_FUNCNAME( EMPTY )}, NULL },
{ "NERROR", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "BIN2U", {HB_FS_STATIC | HB_FS_LOCAL}, {HB_FUNCNAME( BIN2U )}, NULL },
{ "CTOD", {HB_FS_PUBLIC}, {HB_FUNCNAME( CTOD )}, NULL },
{ "UPPER", {HB_FS_PUBLIC}, {HB_FUNCNAME( UPPER )}, NULL },
{ "DTOC", {HB_FS_PUBLIC}, {HB_FUNCNAME( DTOC )}, NULL },
{ "REGSETVALUEEXA", {HB_FS_PUBLIC}, {HB_FUNCNAME( REGSETVALUEEXA )}, NULL },
{ "REGDELETEVALUEA", {HB_FS_PUBLIC}, {HB_FUNCNAME( REGDELETEVALUEA )}, NULL },
{ "BIN2L", {HB_FS_PUBLIC}, {HB_FUNCNAME( BIN2L )}, NULL },
{ "ISREGISTRYKEY", {HB_FS_PUBLIC | HB_FS_LOCAL}, {HB_FUNCNAME( ISREGISTRYKEY )}, NULL },
{ "CLOSE", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "CREATEREGISTRYKEY", {HB_FS_PUBLIC | HB_FS_LOCAL}, {HB_FUNCNAME( CREATEREGISTRYKEY )}, NULL },
{ "GETREGISTRYVALUE", {HB_FS_PUBLIC | HB_FS_LOCAL}, {HB_FUNCNAME( GETREGISTRYVALUE )}, NULL },
{ "GET", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "SETREGISTRYVALUE", {HB_FS_PUBLIC | HB_FS_LOCAL}, {HB_FUNCNAME( SETREGISTRYVALUE )}, NULL },
{ "SET", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "DELETEREGISTRYVAR", {HB_FS_PUBLIC | HB_FS_LOCAL}, {HB_FUNCNAME( DELETEREGISTRYVAR )}, NULL },
{ "DELETE", {HB_FS_PUBLIC | HB_FS_MESSAGE}, {NULL}, NULL },
{ "DELETEREGISTRYKEY", {HB_FS_PUBLIC | HB_FS_LOCAL}, {HB_FUNCNAME( DELETEREGISTRYKEY )}, NULL },
{ "REGDELETEKEY", {HB_FS_PUBLIC}, {HB_FUNCNAME( REGDELETEKEY )}, NULL },
{ "(_INITSTATICS00001)", {HB_FS_INITEXIT | HB_FS_LOCAL}, {hb_INITSTATICS}, NULL }
HB_INIT_SYMBOLS_EX_END( hb_vm_SymbolInit_H_REGISTRY, "h_registry.prg", 0x0, 0x0003 )

#if defined( HB_PRAGMA_STARTUP )
   #pragma startup hb_vm_SymbolInit_H_REGISTRY
#elif defined( HB_DATASEG_STARTUP )
   #define HB_DATASEG_BODY    HB_DATASEG_FUNC( hb_vm_SymbolInit_H_REGISTRY )
   #include "hbiniseg.h"
#endif

HB_FUNC( TREG32 )
{
	static const HB_BYTE pcode[] =
	{
		149,3,0,116,52,0,103,1,0,100,8,29,111,1,
		176,1,0,104,1,0,12,1,29,100,1,166,38,1,
		0,122,80,1,48,2,0,176,3,0,12,0,106,7,
		84,82,101,103,51,50,0,108,4,4,1,0,108,0,
		112,3,80,2,122,80,1,48,5,0,95,2,100,100,
		95,1,106,8,99,82,101,103,75,101,121,0,4,1,
		0,9,112,5,73,48,5,0,95,2,100,100,95,1,
		106,8,110,72,97,110,100,108,101,0,4,1,0,9,
		112,5,73,48,5,0,95,2,100,100,95,1,106,7,
		110,69,114,114,111,114,0,4,1,0,9,112,5,73,
		48,5,0,95,2,100,100,95,1,106,7,108,69,114,
		114,111,114,0,4,1,0,9,112,5,73,48,6,0,
		95,2,106,4,78,101,119,0,108,7,95,1,112,3,
		73,48,6,0,95,2,106,7,67,114,101,97,116,101,
		0,108,8,95,1,112,3,73,48,6,0,95,2,106,
		4,71,101,116,0,108,9,95,1,112,3,73,48,6,
		0,95,2,106,4,83,101,116,0,108,10,95,1,112,
		3,73,48,6,0,95,2,106,7,68,101,108,101,116,
		101,0,108,11,95,1,112,3,73,48,12,0,95,2,
		106,6,67,108,111,115,101,0,89,32,0,1,0,0,
		0,48,13,0,95,1,112,0,28,5,100,25,14,176,
		14,0,48,15,0,95,1,112,0,12,1,6,95,1,
		112,3,73,48,16,0,95,2,112,0,73,167,14,0,
		0,176,17,0,104,1,0,95,2,20,2,168,48,18,
		0,95,2,112,0,80,3,176,19,0,95,3,106,10,
		73,110,105,116,67,108,97,115,115,0,12,2,28,12,
		48,20,0,95,3,164,146,1,0,73,95,3,110,7,
		48,18,0,103,1,0,112,0,110,7
	};

	hb_vmExecute( pcode, symbols );
}

HB_FUNC_STATIC( TREG32_NEW )
{
	static const HB_BYTE pcode[] =
	{
		13,2,3,121,80,4,95,2,100,8,28,7,106,1,
		0,80,2,176,21,0,95,1,95,2,100,176,22,0,
		12,0,28,7,93,63,1,25,4,92,63,96,4,0,
		12,5,80,5,95,5,121,69,28,19,176,21,0,95,
		1,95,2,100,92,25,96,4,0,12,5,80,5,48,
		23,0,102,95,5,121,69,112,1,73,48,13,0,102,
		112,0,28,64,95,3,100,8,31,6,95,3,28,72,
		176,24,0,106,30,69,114,114,111,114,32,111,112,101,
		110,105,110,103,32,84,82,101,103,51,50,32,111,98,
		106,101,99,116,32,40,0,176,25,0,95,5,12,1,
		72,106,2,41,0,72,20,1,25,20,48,26,0,102,
		95,2,112,1,73,48,27,0,102,95,4,112,1,73,
		102,110,7
	};

	hb_vmExecute( pcode, symbols );
}

HB_FUNC_STATIC( TREG32_CREATE )
{
	static const HB_BYTE pcode[] =
	{
		13,2,3,121,80,4,95,2,100,8,28,7,106,1,
		0,80,2,176,28,0,95,1,95,2,96,4,0,12,
		3,80,5,48,23,0,102,95,5,121,69,112,1,73,
		48,13,0,102,112,0,28,65,95,3,100,8,31,6,
		95,3,28,107,176,24,0,106,31,69,114,114,111,114,
		32,99,114,101,97,116,105,110,103,32,84,82,101,103,
		51,50,32,111,98,106,101,99,116,32,40,0,176,25,
		0,95,5,12,1,72,106,2,41,0,72,20,1,25,
		54,48,29,0,102,176,21,0,95,1,95,2,100,176,
		22,0,12,0,28,7,93,63,1,25,4,92,63,96,
		4,0,12,5,112,1,73,48,26,0,102,95,2,112,
		1,73,48,27,0,102,95,4,112,1,73,102,110,7
	};

	hb_vmExecute( pcode, symbols );
}

HB_FUNC_STATIC( TREG32_GET )
{
	static const HB_BYTE pcode[] =
	{
		13,4,2,106,1,0,80,3,121,80,4,121,80,5,
		48,13,0,102,112,0,32,135,0,95,1,100,8,28,
		7,106,1,0,80,1,176,30,0,95,2,12,1,80,
		6,48,29,0,102,176,31,0,48,15,0,102,112,0,
		95,1,121,96,4,0,96,3,0,96,5,0,12,6,
		112,1,73,176,32,0,48,33,0,102,112,0,12,1,
		28,71,95,3,80,2,25,42,176,34,0,95,2,12,
		1,80,2,25,54,176,35,0,95,2,12,1,80,2,
		25,43,176,36,0,95,2,12,1,106,4,46,84,46,
		0,8,80,2,25,25,95,6,133,3,0,106,2,78,
		0,25,207,106,2,68,0,25,212,106,2,76,0,25,
		217,95,2,110,7
	};

	hb_vmExecute( pcode, symbols );
}

HB_FUNC_STATIC( TREG32_SET )
{
	static const HB_BYTE pcode[] =
	{
		13,2,2,48,13,0,102,112,0,31,118,95,1,100,
		8,28,7,106,1,0,80,1,176,30,0,95,2,12,
		1,80,3,95,3,106,2,78,0,8,28,8,92,4,
		80,4,25,57,122,80,4,25,35,176,37,0,95,2,
		12,1,80,2,25,41,95,2,28,10,106,4,46,84,
		46,0,25,8,106,4,46,70,46,0,80,2,25,19,
		95,3,133,2,0,106,2,68,0,25,214,106,2,76,
		0,25,219,48,29,0,102,176,38,0,48,15,0,102,
		112,0,95,1,121,95,4,96,2,0,12,5,112,1,
		73,100,110,7
	};

	hb_vmExecute( pcode, symbols );
}

HB_FUNC_STATIC( TREG32_DELETE )
{
	static const HB_BYTE pcode[] =
	{
		13,0,1,48,13,0,102,112,0,31,22,48,29,0,
		102,176,39,0,48,15,0,102,112,0,95,1,12,2,
		112,1,73,100,110,7
	};

	hb_vmExecute( pcode, symbols );
}

HB_FUNC_STATIC( BIN2U )
{
	static const HB_BYTE pcode[] =
	{
		13,1,1,176,40,0,95,1,12,1,80,2,95,2,
		121,35,28,16,95,2,128,0,0,0,0,1,0,0,
		0,72,25,4,95,2,110,7
	};

	hb_vmExecute( pcode, symbols );
}

HB_FUNC( ISREGISTRYKEY )
{
	static const HB_BYTE pcode[] =
	{
		13,2,2,48,2,0,176,0,0,12,0,95,1,95,
		2,9,112,3,80,3,48,13,0,95,3,112,0,68,
		80,4,48,42,0,95,3,112,0,73,95,4,110,7
	};

	hb_vmExecute( pcode, symbols );
}

HB_FUNC( CREATEREGISTRYKEY )
{
	static const HB_BYTE pcode[] =
	{
		13,2,2,48,16,0,176,0,0,12,0,95,1,95,
		2,9,112,3,80,3,48,13,0,95,3,112,0,68,
		80,4,48,42,0,95,3,112,0,73,95,4,110,7
	};

	hb_vmExecute( pcode, symbols );
}

HB_FUNC( GETREGISTRYVALUE )
{
	static const HB_BYTE pcode[] =
	{
		13,2,4,95,3,100,8,28,7,106,1,0,80,3,
		95,4,100,8,28,8,106,2,67,0,80,4,48,2,
		0,176,0,0,12,0,95,1,95,2,9,112,3,80,
		5,48,13,0,95,5,112,0,31,80,95,4,106,2,
		78,0,8,28,7,121,80,6,25,39,95,4,106,2,
		68,0,8,28,11,134,0,0,0,0,80,6,25,21,
		95,4,106,2,76,0,8,28,7,9,80,6,25,7,
		106,1,0,80,6,48,45,0,95,5,95,3,95,6,
		112,2,80,6,48,33,0,95,5,112,0,121,69,28,
		5,100,80,6,48,42,0,95,5,112,0,73,95,6,
		110,7
	};

	hb_vmExecute( pcode, symbols );
}

HB_FUNC( SETREGISTRYVALUE )
{
	static const HB_BYTE pcode[] =
	{
		13,2,4,9,80,6,95,3,100,8,28,7,106,1,
		0,80,3,48,2,0,176,0,0,12,0,95,1,95,
		2,9,112,3,80,5,48,13,0,95,5,112,0,31,
		25,48,47,0,95,5,95,3,95,4,112,2,73,48,
		33,0,95,5,112,0,121,8,80,6,48,42,0,95,
		5,112,0,73,95,6,110,7
	};

	hb_vmExecute( pcode, symbols );
}

HB_FUNC( DELETEREGISTRYVAR )
{
	static const HB_BYTE pcode[] =
	{
		13,2,3,9,80,5,95,3,100,8,28,7,106,1,
		0,80,3,48,2,0,176,0,0,12,0,95,1,95,
		2,9,112,3,80,4,48,13,0,95,4,112,0,31,
		23,48,49,0,95,4,95,3,112,1,73,48,33,0,
		95,4,112,0,121,8,80,5,48,42,0,95,4,112,
		0,73,95,5,110,7
	};

	hb_vmExecute( pcode, symbols );
}

HB_FUNC( DELETEREGISTRYKEY )
{
	static const HB_BYTE pcode[] =
	{
		13,1,2,176,51,0,95,1,95,2,12,2,121,8,
		80,3,95,3,110,7
	};

	hb_vmExecute( pcode, symbols );
}

HB_FUNC_INITSTATICS()
{
	static const HB_BYTE pcode[] =
	{
		117,52,0,1,0,7
	};

	hb_vmExecute( pcode, symbols );
}

#line 326 "h_registry.prg"

#include <mgdefs.h>

extern HB_PTRUINT wapi_GetProcAddress( HMODULE hModule, LPCSTR lpProcName );

// http://msdn.microsoft.com/en-us/library/ms684139(VS.85).aspx
typedef BOOL ( WINAPI *LPFN_ISWOW64PROCESS ) ( HANDLE, PBOOL );

HB_FUNC_STATIC( ISWOW64 )
{
   BOOL bIsWow64 = FALSE;

   LPFN_ISWOW64PROCESS fnIsWow64Process;

   fnIsWow64Process = ( LPFN_ISWOW64PROCESS ) wapi_GetProcAddress( GetModuleHandle( "kernel32" ), "IsWow64Process" );
   if( NULL != fnIsWow64Process )
   {
      fnIsWow64Process( GetCurrentProcess(), &bIsWow64 );
   }

   hb_retl( bIsWow64 );
}

